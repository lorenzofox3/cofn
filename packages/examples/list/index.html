<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <title>Some test</title>
</head>
<body>
<!--<ul id="list">-->
<!--    <super-li><button>item 1</button></super-li>-->
<!--    <super-li><button>item 2</button></super-li>-->
<!--    <super-li><button>item 3</button></super-li>-->
<!--    <super-li><button>item 4</button></super-li>-->
<!--</ul>-->
<super-list></super-list>
<script type='module'>
    // import {define} from "dom";
    //
    // define('super-li', function* () {
    //     try {
    //         while (true) {
    //             yield;
    //         }
    //     } finally {
    //         console.log('disposed');
    //     }
    // })
    //
    // const observer = new MutationObserver((mutations) => {
    //     const nodes = mutations.flatMap(({removedNodes}) => Array.from(removedNodes));
    // })
    //
    // const list = document.getElementById('list');
    // list.normalize();
    //
    // observer.observe(list, {childList: true, subtree:false});
    //
    // const lis = document.querySelectorAll('super-li');
    //
    // list.addEventListener('click', () => {
    //     list.replaceChildren(...Array.from(lis).filter(el => el.textContent !== 'item 3'));
    // })

    const items = [
        {id: 1, name: 'Article X'},
        {id: 2, name: 'Article Y'},
        {id: 3, name: 'Article Z'},
    ];


    import {define, withView} from 'dom';
    import {List} from './simple-list.js';

    define('super-list', withView(List));

    const list = document.querySelector('super-list');

    const i = setInterval(
        (randomly) => {
            items.sort(randomly);
            try {
                list.render({items});
            }
            catch(error) {
                clearInterval(i);
                throw error;
            }
        },
        1000,
        () => Math.random() - Math.random()
    );

</script>
</body>
</html>